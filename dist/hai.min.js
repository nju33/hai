/*!
 * Copyright 2016, nju33
 * Released under the MIT License
 * https://github.com/totora0155/hai.js
 */
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.Hai=i()}(this,function(){"use strict";function t(){var t=arguments[arguments.length-1];if(null==t)throw Error("Button is required");if(this.caption=arguments[0],this.btns=Array.prototype.slice.call(arguments,1),this.opts={timeout:!1,coverEvent:!0,scrollables:[document.body]},"object"===("undefined"==typeof t?"undefined":b["typeof"](t))){var i=this.btns.pop();null!=i.timeout&&(this.opts.timeout=i.timeout),null!=i.coverEvent&&(this.opts.coverEvent=i.coverEvent),null!=i.scrollables&&(this.opts.scrollables=i.scrollables)}this.callback=null,this._el=null,this._timeoutId=null,this._events=[],p||(f(),p=!0)}function i(t,i){return'<div class="hai__cover"></div><div class="hai__inner"><div class="hai__header"><span class="hai__caption">'+t+'</span></div><div class="hai__body hai__btns--'+i.length+'"></div></div>'}function e(t){for(var i=[],e=0,n=this.btns.length;n>e;e++){var o=document.createElement("a");o.setAttribute("role","button"),o.className="hai__btn",o.innerText=this.btns[e],i.push(o)}return i}function n(){for(var t=0,i=this.btns.length;i>t;t++){var e=this.callback.bind(null,t);this.btns[t].addEventListener("click",e,!1),this._events.push(e)}}function o(){for(var t=0,i=this.btns.length;i>t;t++)this.btns[t].removeEventListener("click",this._events[t],!1);this._events=[]}function s(t){document.body.appendChild(t)}function l(t){for(var i=0,e=0,n=0,o=t.length;o>n;n++)i+=t[n].scrollLeft,e+=t[n].scrollTop;return{left:i,top:e}}function r(t,i){for(var e=t.children[1].children[1],n=0,o=i.length;o>n;n++)e.appendChild(i[n])}function h(t,i,e,n,o){i-=_/2,i+=n,e+=o,window.innerWidth<t.children[1].clientWidth+i&&(i-=t.children[1].clientWidth+i-window.innerWidth),window.innerHeight<t.children[1].clientHeight+e&&(e-=t.children[1].clientHeight+e-window.innerHeight),t.style.left=i+"px",t.style.top=e+"px"}function a(t){var i=t.children[1].clientHeight;t.style.height=i+"px",t.className+=" hai__box--active"}function c(t){t.style.height=0,t.className="hai__box"}function d(t){for(var i=0,e=t.length;e>i;i++)t[i].style.overflow="hidden"}function u(t){for(var i=0,e=t.length;e>i;i++)t[i].style.overflow=null}function f(){var t=document.createElement("style"),i=".hai__box {position: absolute;overflow: hidden;min-width: "+_+"px;height: 0;-webkit-transition: .2s linear height;transition: .2s linear height;}.hai__cover {position: fixed;left: 0;top: 0;-webkit-transition: .2s linear;transition: .2s linear;}.hai__box--active .hai__cover {width: "+window.innerWidth+"px;height: "+window.innerHeight+"px;background: hsla(0, 0%, 0%, .3);}.hai__inner {position: relative;z-index: 99999;background: #e98b2a;}.hai__header {text-align: center;font-weight: bold;box-sizing: border-box;padding: .7em;}.hai__body {overflow: hidden;border-top: 1px solid hsla(0, 0%, 0%, .1);text-align: center;}.hai__btn {display: block;box-sizing: border-box;padding: .7em;cursor: pointer;background: #f0b16f;-webkit-transition: .2s linear background;transition: .2s linear background;}.hai__btn:active {background: #f0bc6f;}";t.innerHTML=i,document.head.appendChild(t)}var b={};b["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},b.classCallCheck=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")};var p=!1,_=120;return t.prototype.show=function(t){return setTimeout(function(){if(this.callback){var t=0,o=0;if(this.opts.scrollables){d(this.opts.scrollables);var c=l(this.opts.scrollables);o=c.left,t=c.top}if(null==this._el&&(this.btns=e.call(this),this._el=document.createElement("div"),this._el.className="hai__box",this._el.innerHTML=i(this.caption,this.btns),this.opts.coverEvent&&this._el.children[0].addEventListener("click",this.hide.bind(this)),r(this._el,this.btns),s(this._el)),n.call(this),h(this._el,u.clientX,u.clientY,o,t),setTimeout(function(){a(this._el)}.bind(this),0),this.opts.timeout)try{this._timeoutId=setTimeout(this.hide.bind(this),this.opts.timeout)}catch(u){throw Error(u)}}}.bind(this),0),{then:function(t){if("function"!=typeof t)throw Error("Please specify the function");this.callback=function(t){var i=this;return function(e){t(e),i.hide()}}.call(this,t)}.bind(this)}},t.prototype.hide=function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null),o.call(this),this.opts.scrollables&&u(this.opts.scrollables),c(this._el)},t});
